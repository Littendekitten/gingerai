<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>GingerAI Internet Data</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    #chatBox { border: 1px solid #ccc; padding: 10px; width: 600px; height: 400px; overflow-y: auto; background: #f9f9f9; }
    input { width: 500px; padding: 5px; }
    button { width: 80px; padding: 5px; }
    p { margin: 5px 0; }
  </style>
</head>
<body>
  <h1>Chat met GingerAI (Internet Data)</h1>
  <div id="chatBox"></div>
  <input id="userInput" type="text" placeholder="Typ hier..." onkeydown="if(event.key==='Enter'){sendMessage()}">
  <button onclick="sendMessage()">Verstuur</button>

  <script>
    const chatBox = document.getElementById("chatBox");

    // --- Dataset NL + EN (kort voorbeeld, je kan je grote dataset hier toevoegen) ---
    const datasetNL = {
      greeting: [["hallo","Hallo! Hoe gaat het?"], ["hoi","Hoi!"]],
      status: [["hoe gaat","Met mij gaat het goed! En met jou?"]],
      bye: [["doei","Doei! Tot de volgende keer!"]]
    };

    const datasetEN = {
      greeting: [["hi","Hey! How are you?"], ["hello","Hello there!"]],
      status: [["how are you","I’m doing great! And you?"]],
      bye: [["bye","Bye! See you later!"]]
    };

    // --- Detecteer taal ---
    function detectLanguage(text) {
      const lower = text.toLowerCase();
      if(lower.match(/[äöüß]/) || lower.includes("hoe") || lower.includes("dag") || lower.includes("huiswerk")) return "nl";
      if(lower.includes("how") || lower.includes("hello") || lower.includes("bye") || lower.includes("homework")) return "en";
      return "nl"; // fallback
    }

    // --- Wikipedia API ophalen ---
    async function fetchWikipedia(query, lang) {
      try {
        const url = `https://${lang}.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`;
        const res = await fetch(url);
        if(!res.ok) return "Geen info gevonden 😅";
        const data = await res.json();
        return `📚 ${data.title}:\n${data.extract}`;
      } catch(e) {
        return "Fout bij ophalen info 😅";
      }
    }

    // --- Generate reply ---
    async function generateReply(msg) {
      const lang = detectLanguage(msg);
      const lower = msg.toLowerCase();
      const dataset = lang === "nl" ? datasetNL : datasetEN;

      // 1️⃣ Controleer triggers uit dataset
      for(const cat in dataset){
        for(const [trigger, response] of dataset[cat]){
          if(lower.includes(trigger)) return response;
        }
      }

      // 2️⃣ Check Wikipedia-feiten
      if(lower.includes("feit") || lower.includes("geef me een feit") || lower.includes("fact")) {
        // willekeurige onderwerpen
        const topics = lang === "nl"
          ? ["Aarde","Zon","Albert Einstein","Chocolate","Programmeren"]
          : ["Earth","Sun","Albert Einstein","Chocolate","Python (programming language)"];
        const topic = topics[Math.floor(Math.random() * topics.length)];
        return await fetchWikipedia(topic, lang === "nl" ? "nl" : "en");
      }

      return lang === "nl" 
        ? "Sorry, dat begrijp ik nog niet helemaal." 
        : "Sorry, I don’t quite understand that yet.";
    }

    // --- Verstuur bericht ---
    async function sendMessage() {
      const userInput = document.getElementById("userInput");
      const text = userInput.value.trim();
      if(!text) return;

      addMessage("Jij", text);

      const reply = await generateReply(text);
      chatBox.scrollTop = chatBox.scrollHeight;

      setTimeout(() => {
        addMessage("GingerAI", reply);
        chatBox.scrollTop = chatBox.scrollHeight;
      }, 300);

      userInput.value = "";
    }

    // --- Voeg bericht toe aan chatbox ---
    function addMessage(sender, text) {
      const p = document.createElement("p");
      p.innerHTML = `<b>${sender}:</b> ${text}`;
      chatBox.appendChild(p);
    }
  </script>
</body>
</html>
