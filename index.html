<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GingerAI Chat</title>
<link rel="icon" href="assets/logo.png">
<style>
html, body {
    margin:0;
    padding:0;
    height:100%;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #FF8A00, #E52E71);
}

#app {
    display:flex;
    height:100%;
    overflow:hidden;
}

/* Sidebar */
#sidebar {
    width:250px;
    background:#fff;
    display:flex;
    flex-direction:column;
    transition: transform 0.3s ease;
    z-index:2;
}
#sidebar.collapsed { transform:translateX(-250px); }

#sidebar-header {
    display:flex;
    align-items:center;
    padding:10px;
    border-bottom:1px solid #ddd;
}
#sidebar-header img { width:30px; height:30px; margin-right:10px; }
#sidebar-header span { font-weight:bold; font-size:1.1em; color:#E52E71; }

#chat-list { flex:1; overflow-y:auto; }
.chat-item {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:8px 10px;
    border-bottom:1px solid #eee;
    cursor:pointer;
}
.chat-item:hover { background:#f0f0f0; }
.chat-item button { background:none; border:none; color:#E52E71; cursor:pointer; font-size:1.1em; }

/* Chat Area */
#chat-area { flex:1; display:flex; flex-direction:column; background:#fff; }
#messages { flex:1; display:flex; flex-direction:column-reverse; overflow-y:auto; padding:10px; }
.message.user { color:#0066cc; margin:4px 0; }
.message.ginger { color:#cc6600; margin:4px 0; }

#input-container {
    display:flex;
    padding:6px 10px;
    border-top:1px solid #ddd;
    background:#fafafa;
}
#message-input { flex:1; padding:8px; border-radius:5px; border:1px solid #ccc; font-size:1em; }
#send-btn { padding:8px 12px; margin-left:5px; border:none; border-radius:5px; background:#E52E71; color:#fff; cursor:pointer; }
#send-btn:hover { background:#FF8A00; }

/* Hamburger */
#hamburger {
    position:absolute;
    top:10px; left:10px;
    z-index:3;
    font-size:1.5em;
    color:#fff;
    cursor:pointer;
}

/* Responsive */
@media(max-width:700px){
    #sidebar { position:absolute; height:100%; left:0; top:0; }
    #chat-area { flex:1; margin-left:0; }
    #messages { font-size:1.2em; }
}
</style>
</head>
<body>
<div id="app">
    <div id="sidebar" class="collapsed">
        <div id="sidebar-header">
            <img src="assets/logo.png" alt="Logo">
            <span>Chats</span>
        </div>
        <button id="new-chat" style="margin:10px; padding:5px 10px; background:#FF8A00; border:none; color:#fff; border-radius:5px; cursor:pointer;">New Chat</button>
        <div id="chat-list"></div>
    </div>
    <div id="chat-area">
        <div id="messages"></div>
        <div id="input-container">
            <input type="text" id="message-input" placeholder="Type your message...">
            <button id="send-btn">Send</button>
        </div>
    </div>
</div>
<div id="hamburger">&#9776;</div>

<script src="train_gingerai.js"></script>
<script>
const sidebar = document.getElementById('sidebar');
const hamburger = document.getElementById('hamburger');
const newChatBtn = document.getElementById('new-chat');
const chatList = document.getElementById('chat-list');
const messages = document.getElementById('messages');
const input = document.getElementById('message-input');
const sendBtn = document.getElementById('send-btn');

let chats = [];
let currentChatId = null;

// Hamburger toggle
hamburger.addEventListener('click', ()=>{ sidebar.classList.toggle('collapsed'); });

// Create new chat
function createChat(name){
    const id = Date.now().toString();
    chats.push({id, name:name||`Chat ${chats.length+1}`, messages:[]});
    renderChatList();
    openChat(id);
}

// Render chat list
function renderChatList(){
    chatList.innerHTML = '';
    chats.forEach(c=>{
        const div = document.createElement('div');
        div.className='chat-item';
        div.innerHTML=`<span>${c.name}</span><button onclick="deleteChat('${c.id}')">ðŸ—‘</button>`;
        div.addEventListener('click',()=>openChat(c.id));
        chatList.appendChild(div);
    });
}

// Delete chat
window.deleteChat = function(id){
    chats = chats.filter(c=>c.id!==id);
    if(currentChatId===id) currentChatId=null;
    renderChatList();
    renderMessages();
}

// Open chat
function openChat(id){
    currentChatId=id;
    renderMessages();
}

// Render messages
function renderMessages(){
    messages.innerHTML='';
    if(!currentChatId) return;
    const chat = chats.find(c=>c.id===currentChatId);
    chat.messages.slice().reverse().forEach(m=>{
        addMessageToDOM(m.text,m.sender,false);
    });
}

// Add message
function addMessageToDOM(text,sender,save=true){
    const div=document.createElement('div');
    div.classList.add('message',sender);
    div.textContent=text;
    messages.prepend(div);
    if(currentChatId && save){
        const chat=chats.find(c=>c.id===currentChatId);
        chat.messages.push({text,sender});
    }
}

// Send message
async function sendMessage(){
    const text=input.value.trim();
    if(!text) return;
    if(!currentChatId) createChat();
    addMessageToDOM(text,'user');
    input.value='';
    try{
        const response=await window.GingerAI.ask(text);
        addMessageToDOM(response,'ginger');
    }catch(e){ addMessageToDOM("Error: GingerAI unavailable.",'ginger'); }
}

sendBtn.addEventListener('click',sendMessage);
input.addEventListener('keydown',e=>{if(e.key==='Enter')sendMessage();});
newChatBtn.addEventListener('click',()=>createChat());
</script>
</body>
</html>
